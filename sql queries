create table items1(item_id int,
				  item_name nvarchar(320),
				  item_category varchar(255))

select * from itemsaj

select * from business1

alter table business1 
add column week_day varchar(250)

update business1
set week_day=to_char(order_date,'day')

select item_category,week_day,sum(quantity) from business1
inner join itemsaj
on business1.item_id=itemsaj.item_id
group by itemsaj.item_category,week_day


create table emp(Id int,
				Name varchar(250),
				Salary int,
				DepartmentId int)
				
insert into emp(Id,Name,Salary,DepartmentId)
values (7,	'Will',	70000,	1)

create table dept(Id int,
				 Name varchar(250)
insert into dept(Id,Name)
values ('2','SALES')

ALTER TABLE dept
RENAME COLUMN Name TO Dname

select * from dept				  

select * from emp
inner join dept
on dept.Id=emp.DepartmentId

				  
select a.Name,a.salary,a.dname,a.rank from 
 (select emp.Name,dept.dname,emp.salary ,
  dense_rank() OVER(PARTITION BY dept.dname ORDER BY emp.Salary desc) as rank from emp
  inner JOIN dept
on dept.Id=emp.DepartmentId	
) as a
				  where a.rank<4
				  
SELECT * FROM market1				  

				  
SELECT *,
      avg(amount) OVER (
        ORDER BY visited_on
        ROWS BETWEEN
          2 PRECEDING AND
          CURRENT ROW
      ) AS moving_average
FROM market1
ORDER BY visited_on
				  				  
